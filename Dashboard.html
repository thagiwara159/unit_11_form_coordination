<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ãƒ†ã‚¹ãƒˆç®¡ç†</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container mt-4">
    <div class="card">
      <div class="card-header bg-primary text-white text-center">
        <h3> ãƒ†ã‚¹ãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  </h3>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <h5> ã‚·ã‚¹ãƒ†ãƒ æ“ä½œ</h5> 
<div class="d-grid gap-2">
            <button class="btn btn-success" onclick="createForm()">
              ğŸ“ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆ
            </button>
            <button class="btn btn-info" onclick="setupTrigger()">
              âš™ï¸è‡ªå‹•æ¡ç‚¹è¨­å®š
            </button>
            <button class="btn btn-warning" onclick="generateReport()">
              ğŸ“Šåˆ†æãƒ¬ãƒãƒ¼ãƒˆ
            </button>
          </div>
        </div>
        <div class="col-md-6">
          <h5> ğŸ“ˆçµ±è¨ˆæƒ…å ±</h5>
          <div id="stats">
            <button class="btn btn-outline-primary" onclick="loadStats()">
              çµ±è¨ˆã‚’è¡¨ç¤º
            </button>
          </div>
        </div>
</div></div></div></div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
function createForm() {
    google.script.run
      .withSuccessHandler(() => alert('ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã—ãŸï¼ '))
      .withFailureHandler(err => alert('ã‚¨ãƒ©ãƒ¼: ' + err.message))
      .createTestForm();
}

function setupTrigger() {
    google.script.run
      .withSuccessHandler(() => alert('è‡ªå‹•æ¡ç‚¹ã‚’è¨­å®šã—ã¾ã—ãŸï¼ '))
      .withFailureHandler(err => alert('ã‚¨ãƒ©ãƒ¼: ' + err.message))
      .setupTrigger();
}

function generateReport() {
    google.script.run
      .withSuccessHandler(() => alert('ãƒ¬ãƒãƒ¼ãƒˆã‚’é€ä¿¡ã—ã¾ã—ãŸï¼ '))
      .withFailureHandler(err => alert('ã‚¨ãƒ©ãƒ¼: ' + err.message))
      .generateReport();
}

function loadStats() {
    google.script.run
      .withSuccessHandler(displayStats)
      .withFailureHandler(err => alert('ã‚¨ãƒ©ãƒ¼: ' + err.message))
      .getStats();
}

function displayStats(stats) {
    if (!stats) {
      document.getElementById('stats').innerHTML = '<p>ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ </p>';
      return;
    }
    document.getElementById('stats').innerHTML = `
      <div class="card">
        <div class="card-body">
          <p><strong>å—é¨“è€…æ•°:</strong> ${stats.totalStudents}å</p>
          <p><strong>å¹³å‡ç‚¹:</strong> ${stats.averageScore}ç‚¹</p>
          <p><strong>åˆæ ¼ç‡:</strong> ${stats.passRate}%</p>
        </div>
      </div>`; }</script></body></html>
